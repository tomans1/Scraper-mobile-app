<!DOCTYPE html>
<html lang="sk">
<head>
  <!-- Litepicker -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/litepicker/dist/css/litepicker.css">
  <script src="https://cdn.jsdelivr.net/npm/litepicker/dist/bundle.js"></script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Inferno Scraper</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="static/css/styles.css">
  <script src="static/js/app.js" defer></script>

  
</head>

<body class="bg-gray-100 text-gray-900 font-sans flex flex-col items-center min-h-screen p-6 space-y-8">
  <div id="auth-modal" class="fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-80">
    <form id="auth-form" class="bg-white p-6 rounded shadow space-y-4">
      <h2 class="text-xl font-bold">Zadaj heslo</h2>
      <div class="flex items-center justify-between text-sm">
        <div class="flex items-center gap-2" data-server-status>
          <span class="w-3 h-3 rounded-full bg-yellow-500" data-status-dot></span>
          <span class="text-yellow-600" data-status-text>Kontrolujem‚Ä¶</span>
        </div>
        <button type="button"
                class="text-xs text-blue-600 hover:text-blue-500 hidden"
                data-wake-button
                data-wake-label="Prebudi≈• server">
          Prebudi≈• server
        </button>
      </div>
      <input id="auth-password" type="password" class="border p-2 rounded w-64" />
      <p id="auth-error" class="text-red-500 text-sm hidden"></p>
      <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Prihl√°si≈•</button>
    </form>
  </div>
  <div id="app" class="hidden contents">
  <div class="fixed top-2 right-8 flex items-center gap-4">
    <div class="flex items-center gap-2 text-xs" data-server-status>
      <span class="w-2.5 h-2.5 rounded-full bg-yellow-500" data-status-dot></span>
      <span class="text-yellow-600" data-status-text>Kontrolujem‚Ä¶</span>
    </div>
    <!-- Design button + tooltip -->
    <div class="relative group">
      <a
        href="https://bazosscraper.onrender.com//Design.html"
        target="_blank"
        class="flex items-center gap-1 text-gray-500 hover:text-gray-400 active:scale-90 font-medium transition-all duration-150"
      >
        üé® <span class="text-sm">Dizajn</span>
      </a>
      <div class="absolute right-0 mt-1 w-72 bg-gray-800 text-gray-100 text-xs rounded-lg shadow-lg px-3 py-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10">
        Toto je n√°pad ako by str√°nka mohla vyzera≈•, ak by si chcel aby vyzerala kraj≈°ie
      </div>
    </div>

    <!-- Reset button + tooltip -->
    <div class="relative group">
      <button
        id="restart-icon"
        onclick="restartApp()"
        class="flex items-center gap-1 text-gray-500 hover:text-gray-400 active:scale-90 font-medium transition-all duration-150"
      >
        üîÑ <span class="text-sm">Reset</span>
      </button>
      <div class="absolute right-0 mt-1 w-60 bg-gray-800 text-gray-100 text-xs rounded-lg shadow-lg px-3 py-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-10">
        Ak re≈°tartuje≈°, poƒçkaj minutku predt√Ωm ako spust√≠≈° nov√Ω zber
      </div>
    </div>

    <button id="logout-link" class="text-sm text-gray-500 hover:text-gray-400">Odhl√°si≈• sa</button>
  </div>

  <div class="bg-white shadow-xl rounded-xl p-8 max-w-2xl w-full">
    <h1 class="text-3xl font-bold text-center mb-4">üî• Inferno Scraper</h1>

    <button type="button" id="filters-toggle" onclick="toggleAdvancedFilters()"
            class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-3 rounded hidden">
      ‚öôÔ∏è Zobrazi≈• filtre
    </button>

    <!-- ---------- FILTERS ---------- -->
    <div id="advanced-filters" class="hidden mt-4 space-y-6">

      <!-- subcats -->
      <div>
        <label class="block font-medium mb-1">Podkateg√≥rie:</label>
        <div id="subcat-dropdown" class="relative">
          <button type="button" id="subcat-dropdown-toggle"
                  class="w-full border border-gray-300 rounded-lg px-3 py-2 flex items-center justify-between text-left bg-white hover:bg-gray-50">
            <span id="subcat-dropdown-label" class="truncate">Vyberte podkateg√≥rie</span>
            <span class="ml-2 text-gray-400">‚ñæ</span>
          </button>
          <div id="subcat-options"
               class="absolute mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-56 overflow-y-auto hidden z-20 p-2 space-y-1"></div>
        </div>
      </div>

      <!-- cities -->
      <div>
        <label class="block font-medium mb-1">Mest√°:</label>
        <div id="city-filter" class="relative">
          <input id="city-search" type="text" placeholder="Hƒæada≈• mesto"
                 class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-400"
                 autocomplete="off">
          <div id="city-options"
               class="absolute mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-56 overflow-y-auto hidden z-20"></div>
        </div>
        <p id="city-selection-hint" class="text-xs text-gray-500 mt-1 hidden"></p>
      </div>

      <!-- zip codes -->
      <div>
        <label class="block font-medium mb-1">PSƒå:</label>
        <div id="zip-filter" class="relative">
          <input id="zip-search" type="text" placeholder="Hƒæada≈• PSƒå"
                 class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-400"
                 autocomplete="off">
          <div id="zip-options"
               class="absolute mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-56 overflow-y-auto hidden z-20"></div>
        </div>
        <p id="zip-selection-hint" class="text-xs text-gray-500 mt-1 hidden"></p>
      </div>

      <!-- date -->
      <div class="space-y-2">
        <label class="block font-medium">D√°tum:</label>
        <div class="flex gap-2">
          <input id="date-range" class="border border-gray-300 rounded-lg p-2 w-full text-sm" placeholder="Vyberte d√°tumy" readonly disabled>
          <button type="button" id="date-apply-btn"
                  class="px-3 py-2 bg-indigo-500 text-white text-sm rounded-lg hidden disabled:opacity-60 disabled:cursor-not-allowed">
            Pou≈æi≈•
          </button>
        </div>
        <label class="inline-flex items-center mt-2">
          <input id="new-only" type="checkbox" class="form-checkbox text-red-500 mr-2" onchange="toggleDateInputs(this)" disabled>
          Iba nov√© inzer√°ty
        </label>
      </div>
    </div>

    <!-- ---------- ACTIONS ---------- -->
    <div id="start-buttons" class="mt-6 flex justify-center space-x-6">
      <button type="button" onclick="event.preventDefault(); startScrape('new')"
              class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-lg">
        Spusti≈• nov√Ω zber
      </button>
      <button type="button" onclick="event.preventDefault(); startScrape('old')"
              class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg">
        Zobrazi≈• predch√°dzaj√∫ce v√Ωsledky
      </button>
    </div>
    <div class="mt-6 flex justify-center">
      <button id="cancel-btn" type="button" onclick="event.preventDefault(); cancelScrape();"
              class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-lg hidden">
        ‚ùå Zru≈°i≈• zber
      </button>
    </div>


    <!-- ---------- PROGRESS ---------- -->
    <div id="progress-bar" class="mt-6 hidden">
      <div id="progress-label" class="block font-medium mb-1"></div>
      <div class="w-full bg-gray-300 rounded-full h-4">
        <div id="progress" class="bg-indigo-500 h-4 rounded-full" style="width:0%"></div>
      </div>
      <div id="stage-label" class="mt-2 text-sm text-gray-600"></div>
    </div>

    <!-- ---------- RESULTS ---------- -->
    <div id="results-section" class="mt-8 hidden">
      <div class="flex justify-between items-center mb-1">
        <h2 class="font-semibold">V√Ωsledky:</h2>
        <p id="results-count" class="text-sm text-gray-500"></p>
        <button id="download-btn"
                class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-3 rounded text-sm">
          ‚¨áÔ∏è Stiahnu≈•
        </button>
      </div>
      <div id="output" class="text-sm bg-gray-50 p-4 rounded border border-gray-200 h-40 overflow-y-scroll space-y-1"></div>
    </div>

    <!-- ---------- FEEDBACK ---------- -->
    <div class="mt-4">
      <button type="button" onclick="document.getElementById('feedback-box').classList.toggle('hidden')"
              class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded">
        üí¨ Prida≈• agent√∫ru
      </button>

      <div id="feedback-box" class="hidden mt-2">
        <textarea rows="2" class="w-full border border-gray-300 rounded-lg p-2"
                  placeholder="Na≈°iel si medzi v√Ωdsledkami agent√∫ru? Nap√≠≈° ju sem (napr. 'inferno')"></textarea>
        <button type="button" onclick="sendFeedback()"
                class="mt-2 bg-gray-700 hover:bg-gray-800 text-white font-bold py-1 px-4 rounded">
          Odosla≈•
        </button>
      </div>
    </div>
  </div>
</div>
</body>
</html>
